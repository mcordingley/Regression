<?php

use mcordingley\Regression\Linkings\Logistic;
use mcordingley\Regression\Observations;
use mcordingley\Regression\Predictor;
use mcordingley\Regression\RegressionAlgorithms\GradientDescent;

final class LogisticTest extends PHPUnit_Framework_TestCase
{
    private $observations;
    private $predictor;
    private $regression;

    public function __construct($name = null, array $data = array(), $dataName = '')
    {
        parent::__construct($name, $data, $dataName);

        // Data from http://statistics.ats.ucla.edu/stat/r/dae/logit.htm
        $this->observations = new Observations;

        // [GRE, GPA, Rank2, Rank3, Rank4]
        $this->observations->addObservation(0, [380, 3.61, 0, 1, 0]);
        $this->observations->addObservation(1, [660, 3.67, 0, 1, 0]);
        $this->observations->addObservation(1, [800, 4, 0, 0, 0]);
        $this->observations->addObservation(1, [640, 3.19, 0, 0, 1]);
        $this->observations->addObservation(0, [520, 2.93, 0, 0, 1]);
        $this->observations->addObservation(1, [760, 3, 1, 0, 0]);
        $this->observations->addObservation(1, [560, 2.98, 0, 0, 0]);
        $this->observations->addObservation(0, [400, 3.08, 1, 0, 0]);
        $this->observations->addObservation(1, [540, 3.39, 0, 1, 0]);
        $this->observations->addObservation(0, [700, 3.92, 1, 0, 0]);
        $this->observations->addObservation(0, [800, 4, 0, 0, 1]);
        $this->observations->addObservation(0, [440, 3.22, 0, 0, 0]);
        $this->observations->addObservation(1, [760, 4, 0, 0, 0]);
        $this->observations->addObservation(0, [700, 3.08, 1, 0, 0]);
        $this->observations->addObservation(1, [700, 4, 0, 0, 0]);
        $this->observations->addObservation(0, [480, 3.44, 0, 1, 0]);
        $this->observations->addObservation(0, [780, 3.87, 0, 0, 1]);
        $this->observations->addObservation(0, [360, 2.56, 0, 1, 0]);
        $this->observations->addObservation(0, [800, 3.75, 1, 0, 0]);
        $this->observations->addObservation(1, [540, 3.81, 0, 0, 0]);
        $this->observations->addObservation(0, [500, 3.17, 0, 1, 0]);
        $this->observations->addObservation(1, [660, 3.63, 1, 0, 0]);
        $this->observations->addObservation(0, [600, 2.82, 0, 0, 1]);
        $this->observations->addObservation(0, [680, 3.19, 0, 0, 1]);
        $this->observations->addObservation(1, [760, 3.35, 1, 0, 0]);
        $this->observations->addObservation(1, [800, 3.66, 0, 0, 0]);
        $this->observations->addObservation(1, [620, 3.61, 0, 0, 0]);
        $this->observations->addObservation(1, [520, 3.74, 0, 0, 1]);
        $this->observations->addObservation(1, [780, 3.22, 1, 0, 0]);
        $this->observations->addObservation(0, [520, 3.29, 0, 0, 0]);
        $this->observations->addObservation(0, [540, 3.78, 0, 0, 1]);
        $this->observations->addObservation(0, [760, 3.35, 0, 1, 0]);
        $this->observations->addObservation(0, [600, 3.4, 0, 1, 0]);
        $this->observations->addObservation(1, [800, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [360, 3.14, 0, 0, 0]);
        $this->observations->addObservation(0, [400, 3.05, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 3.25, 0, 0, 0]);
        $this->observations->addObservation(0, [520, 2.9, 0, 1, 0]);
        $this->observations->addObservation(1, [500, 3.13, 1, 0, 0]);
        $this->observations->addObservation(1, [520, 2.68, 0, 1, 0]);
        $this->observations->addObservation(0, [560, 2.42, 1, 0, 0]);
        $this->observations->addObservation(1, [580, 3.32, 1, 0, 0]);
        $this->observations->addObservation(1, [600, 3.15, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 3.31, 0, 1, 0]);
        $this->observations->addObservation(0, [700, 2.94, 1, 0, 0]);
        $this->observations->addObservation(1, [460, 3.45, 0, 1, 0]);
        $this->observations->addObservation(1, [580, 3.46, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 2.97, 0, 0, 1]);
        $this->observations->addObservation(0, [440, 2.48, 0, 0, 1]);
        $this->observations->addObservation(0, [400, 3.35, 0, 1, 0]);
        $this->observations->addObservation(0, [640, 3.86, 0, 1, 0]);
        $this->observations->addObservation(0, [440, 3.13, 0, 0, 1]);
        $this->observations->addObservation(0, [740, 3.37, 0, 0, 1]);
        $this->observations->addObservation(1, [680, 3.27, 1, 0, 0]);
        $this->observations->addObservation(0, [660, 3.34, 0, 1, 0]);
        $this->observations->addObservation(1, [740, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [560, 3.19, 0, 1, 0]);
        $this->observations->addObservation(0, [380, 2.94, 0, 1, 0]);
        $this->observations->addObservation(0, [400, 3.65, 1, 0, 0]);
        $this->observations->addObservation(0, [600, 2.82, 0, 0, 1]);
        $this->observations->addObservation(1, [620, 3.18, 1, 0, 0]);
        $this->observations->addObservation(0, [560, 3.32, 0, 0, 1]);
        $this->observations->addObservation(0, [640, 3.67, 0, 1, 0]);
        $this->observations->addObservation(1, [680, 3.85, 0, 1, 0]);
        $this->observations->addObservation(0, [580, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [600, 3.59, 1, 0, 0]);
        $this->observations->addObservation(0, [740, 3.62, 0, 0, 1]);
        $this->observations->addObservation(0, [620, 3.3, 0, 0, 0]);
        $this->observations->addObservation(0, [580, 3.69, 0, 0, 0]);
        $this->observations->addObservation(0, [800, 3.73, 0, 0, 0]);
        $this->observations->addObservation(0, [640, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [300, 2.92, 0, 0, 1]);
        $this->observations->addObservation(0, [480, 3.39, 0, 0, 1]);
        $this->observations->addObservation(0, [580, 4, 1, 0, 0]);
        $this->observations->addObservation(0, [720, 3.45, 0, 0, 1]);
        $this->observations->addObservation(0, [720, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [560, 3.36, 0, 1, 0]);
        $this->observations->addObservation(1, [800, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [540, 3.12, 0, 0, 0]);
        $this->observations->addObservation(1, [620, 4, 0, 0, 0]);
        $this->observations->addObservation(0, [700, 2.9, 0, 0, 1]);
        $this->observations->addObservation(0, [620, 3.07, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 2.71, 1, 0, 0]);
        $this->observations->addObservation(0, [380, 2.91, 0, 0, 1]);
        $this->observations->addObservation(1, [500, 3.6, 0, 1, 0]);
        $this->observations->addObservation(0, [520, 2.98, 1, 0, 0]);
        $this->observations->addObservation(0, [600, 3.32, 1, 0, 0]);
        $this->observations->addObservation(0, [600, 3.48, 1, 0, 0]);
        $this->observations->addObservation(0, [700, 3.28, 0, 0, 0]);
        $this->observations->addObservation(1, [660, 4, 1, 0, 0]);
        $this->observations->addObservation(0, [700, 3.83, 1, 0, 0]);
        $this->observations->addObservation(1, [720, 3.64, 0, 0, 0]);
        $this->observations->addObservation(0, [800, 3.9, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 2.93, 1, 0, 0]);
        $this->observations->addObservation(1, [660, 3.44, 1, 0, 0]);
        $this->observations->addObservation(0, [660, 3.33, 1, 0, 0]);
        $this->observations->addObservation(0, [640, 3.52, 0, 0, 1]);
        $this->observations->addObservation(0, [480, 3.57, 1, 0, 0]);
        $this->observations->addObservation(0, [700, 2.88, 1, 0, 0]);
        $this->observations->addObservation(0, [400, 3.31, 0, 1, 0]);
        $this->observations->addObservation(0, [340, 3.15, 0, 1, 0]);
        $this->observations->addObservation(0, [580, 3.57, 0, 1, 0]);
        $this->observations->addObservation(0, [380, 3.33, 0, 0, 1]);
        $this->observations->addObservation(0, [540, 3.94, 0, 1, 0]);
        $this->observations->addObservation(1, [660, 3.95, 1, 0, 0]);
        $this->observations->addObservation(1, [740, 2.97, 1, 0, 0]);
        $this->observations->addObservation(1, [700, 3.56, 0, 0, 0]);
        $this->observations->addObservation(0, [480, 3.13, 1, 0, 0]);
        $this->observations->addObservation(0, [400, 2.93, 0, 1, 0]);
        $this->observations->addObservation(0, [480, 3.45, 1, 0, 0]);
        $this->observations->addObservation(0, [680, 3.08, 0, 0, 1]);
        $this->observations->addObservation(0, [420, 3.41, 0, 0, 1]);
        $this->observations->addObservation(0, [360, 3, 0, 1, 0]);
        $this->observations->addObservation(0, [600, 3.22, 0, 0, 0]);
        $this->observations->addObservation(0, [720, 3.84, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.99, 0, 1, 0]);
        $this->observations->addObservation(1, [440, 3.45, 1, 0, 0]);
        $this->observations->addObservation(0, [700, 3.72, 1, 0, 0]);
        $this->observations->addObservation(1, [800, 3.7, 0, 0, 0]);
        $this->observations->addObservation(0, [340, 2.92, 0, 1, 0]);
        $this->observations->addObservation(1, [520, 3.74, 1, 0, 0]);
        $this->observations->addObservation(1, [480, 2.67, 1, 0, 0]);
        $this->observations->addObservation(0, [520, 2.85, 0, 1, 0]);
        $this->observations->addObservation(0, [500, 2.98, 0, 1, 0]);
        $this->observations->addObservation(0, [720, 3.88, 0, 1, 0]);
        $this->observations->addObservation(0, [540, 3.38, 0, 0, 1]);
        $this->observations->addObservation(1, [600, 3.54, 0, 0, 0]);
        $this->observations->addObservation(0, [740, 3.74, 0, 0, 1]);
        $this->observations->addObservation(0, [540, 3.19, 1, 0, 0]);
        $this->observations->addObservation(0, [460, 3.15, 0, 0, 1]);
        $this->observations->addObservation(1, [620, 3.17, 1, 0, 0]);
        $this->observations->addObservation(0, [640, 2.79, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 3.4, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 3.08, 0, 1, 0]);
        $this->observations->addObservation(0, [560, 2.95, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 3.57, 0, 1, 0]);
        $this->observations->addObservation(0, [560, 3.33, 0, 0, 1]);
        $this->observations->addObservation(0, [700, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.4, 1, 0, 0]);
        $this->observations->addObservation(1, [600, 3.58, 0, 0, 0]);
        $this->observations->addObservation(0, [640, 3.93, 1, 0, 0]);
        $this->observations->addObservation(1, [700, 3.52, 0, 0, 1]);
        $this->observations->addObservation(0, [620, 3.94, 0, 0, 1]);
        $this->observations->addObservation(0, [580, 3.4, 0, 1, 0]);
        $this->observations->addObservation(0, [580, 3.4, 0, 0, 1]);
        $this->observations->addObservation(0, [380, 3.43, 0, 1, 0]);
        $this->observations->addObservation(0, [480, 3.4, 1, 0, 0]);
        $this->observations->addObservation(0, [560, 2.71, 0, 1, 0]);
        $this->observations->addObservation(1, [480, 2.91, 0, 0, 0]);
        $this->observations->addObservation(0, [740, 3.31, 0, 0, 0]);
        $this->observations->addObservation(1, [800, 3.74, 0, 0, 0]);
        $this->observations->addObservation(0, [400, 3.38, 1, 0, 0]);
        $this->observations->addObservation(1, [640, 3.94, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 3.46, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.69, 0, 1, 0]);
        $this->observations->addObservation(1, [580, 2.86, 0, 0, 1]);
        $this->observations->addObservation(0, [560, 2.52, 1, 0, 0]);
        $this->observations->addObservation(1, [480, 3.58, 0, 0, 0]);
        $this->observations->addObservation(0, [660, 3.49, 1, 0, 0]);
        $this->observations->addObservation(0, [700, 3.82, 0, 1, 0]);
        $this->observations->addObservation(0, [600, 3.13, 1, 0, 0]);
        $this->observations->addObservation(0, [640, 3.5, 1, 0, 0]);
        $this->observations->addObservation(1, [700, 3.56, 1, 0, 0]);
        $this->observations->addObservation(0, [520, 2.73, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 3.3, 1, 0, 0]);
        $this->observations->addObservation(0, [700, 4, 0, 0, 0]);
        $this->observations->addObservation(0, [440, 3.24, 0, 0, 1]);
        $this->observations->addObservation(0, [720, 3.77, 0, 1, 0]);
        $this->observations->addObservation(0, [500, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [600, 3.62, 0, 1, 0]);
        $this->observations->addObservation(0, [400, 3.51, 0, 1, 0]);
        $this->observations->addObservation(0, [540, 2.81, 0, 1, 0]);
        $this->observations->addObservation(0, [680, 3.48, 0, 1, 0]);
        $this->observations->addObservation(1, [800, 3.43, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 3.53, 0, 0, 1]);
        $this->observations->addObservation(1, [620, 3.37, 1, 0, 0]);
        $this->observations->addObservation(0, [520, 2.62, 1, 0, 0]);
        $this->observations->addObservation(1, [620, 3.23, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.33, 0, 1, 0]);
        $this->observations->addObservation(0, [300, 3.01, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.78, 0, 1, 0]);
        $this->observations->addObservation(0, [500, 3.88, 0, 0, 1]);
        $this->observations->addObservation(0, [700, 4, 1, 0, 0]);
        $this->observations->addObservation(1, [540, 3.84, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 2.79, 0, 0, 1]);
        $this->observations->addObservation(0, [800, 3.6, 1, 0, 0]);
        $this->observations->addObservation(0, [560, 3.61, 0, 1, 0]);
        $this->observations->addObservation(0, [580, 2.88, 1, 0, 0]);
        $this->observations->addObservation(0, [560, 3.07, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 3.35, 1, 0, 0]);
        $this->observations->addObservation(1, [640, 2.94, 1, 0, 0]);
        $this->observations->addObservation(0, [800, 3.54, 0, 1, 0]);
        $this->observations->addObservation(0, [640, 3.76, 0, 1, 0]);
        $this->observations->addObservation(0, [380, 3.59, 0, 0, 1]);
        $this->observations->addObservation(1, [600, 3.47, 1, 0, 0]);
        $this->observations->addObservation(0, [560, 3.59, 1, 0, 0]);
        $this->observations->addObservation(0, [660, 3.07, 0, 1, 0]);
        $this->observations->addObservation(1, [400, 3.23, 0, 0, 1]);
        $this->observations->addObservation(0, [600, 3.63, 0, 1, 0]);
        $this->observations->addObservation(0, [580, 3.77, 0, 0, 1]);
        $this->observations->addObservation(0, [800, 3.31, 0, 1, 0]);
        $this->observations->addObservation(1, [580, 3.2, 1, 0, 0]);
        $this->observations->addObservation(1, [700, 4, 0, 0, 0]);
        $this->observations->addObservation(0, [420, 3.92, 0, 0, 1]);
        $this->observations->addObservation(1, [600, 3.89, 0, 0, 0]);
        $this->observations->addObservation(1, [780, 3.8, 0, 1, 0]);
        $this->observations->addObservation(0, [740, 3.54, 0, 0, 0]);
        $this->observations->addObservation(1, [640, 3.63, 0, 0, 0]);
        $this->observations->addObservation(0, [540, 3.16, 0, 1, 0]);
        $this->observations->addObservation(0, [580, 3.5, 1, 0, 0]);
        $this->observations->addObservation(0, [740, 3.34, 0, 0, 1]);
        $this->observations->addObservation(0, [580, 3.02, 1, 0, 0]);
        $this->observations->addObservation(0, [460, 2.87, 1, 0, 0]);
        $this->observations->addObservation(0, [640, 3.38, 0, 1, 0]);
        $this->observations->addObservation(1, [600, 3.56, 1, 0, 0]);
        $this->observations->addObservation(1, [660, 2.91, 0, 1, 0]);
        $this->observations->addObservation(0, [340, 2.9, 0, 0, 0]);
        $this->observations->addObservation(1, [460, 3.64, 0, 0, 0]);
        $this->observations->addObservation(0, [460, 2.98, 0, 0, 0]);
        $this->observations->addObservation(1, [560, 3.59, 1, 0, 0]);
        $this->observations->addObservation(0, [540, 3.28, 0, 1, 0]);
        $this->observations->addObservation(0, [680, 3.99, 0, 1, 0]);
        $this->observations->addObservation(1, [480, 3.02, 0, 0, 0]);
        $this->observations->addObservation(0, [800, 3.47, 0, 1, 0]);
        $this->observations->addObservation(0, [800, 2.9, 1, 0, 0]);
        $this->observations->addObservation(1, [720, 3.5, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.58, 1, 0, 0]);
        $this->observations->addObservation(0, [540, 3.02, 0, 0, 1]);
        $this->observations->addObservation(0, [480, 3.43, 1, 0, 0]);
        $this->observations->addObservation(1, [720, 3.42, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 3.29, 0, 0, 1]);
        $this->observations->addObservation(0, [600, 3.28, 0, 1, 0]);
        $this->observations->addObservation(0, [380, 3.38, 1, 0, 0]);
        $this->observations->addObservation(0, [420, 2.67, 0, 1, 0]);
        $this->observations->addObservation(1, [800, 3.53, 0, 0, 0]);
        $this->observations->addObservation(0, [620, 3.05, 1, 0, 0]);
        $this->observations->addObservation(1, [660, 3.49, 1, 0, 0]);
        $this->observations->addObservation(0, [480, 4, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 2.86, 0, 0, 1]);
        $this->observations->addObservation(0, [700, 3.45, 0, 1, 0]);
        $this->observations->addObservation(0, [440, 2.76, 1, 0, 0]);
        $this->observations->addObservation(1, [520, 3.81, 0, 0, 0]);
        $this->observations->addObservation(1, [680, 2.96, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.22, 1, 0, 0]);
        $this->observations->addObservation(0, [540, 3.04, 0, 0, 0]);
        $this->observations->addObservation(0, [800, 3.91, 0, 1, 0]);
        $this->observations->addObservation(0, [680, 3.34, 1, 0, 0]);
        $this->observations->addObservation(0, [440, 3.17, 1, 0, 0]);
        $this->observations->addObservation(0, [680, 3.64, 0, 1, 0]);
        $this->observations->addObservation(0, [640, 3.73, 0, 1, 0]);
        $this->observations->addObservation(0, [660, 3.31, 0, 0, 1]);
        $this->observations->addObservation(0, [620, 3.21, 0, 0, 1]);
        $this->observations->addObservation(1, [520, 4, 1, 0, 0]);
        $this->observations->addObservation(1, [540, 3.55, 0, 0, 1]);
        $this->observations->addObservation(1, [740, 3.52, 0, 0, 1]);
        $this->observations->addObservation(0, [640, 3.35, 0, 1, 0]);
        $this->observations->addObservation(1, [520, 3.3, 1, 0, 0]);
        $this->observations->addObservation(1, [620, 3.95, 0, 1, 0]);
        $this->observations->addObservation(0, [520, 3.51, 1, 0, 0]);
        $this->observations->addObservation(0, [640, 3.81, 1, 0, 0]);
        $this->observations->addObservation(0, [680, 3.11, 1, 0, 0]);
        $this->observations->addObservation(0, [440, 3.15, 1, 0, 0]);
        $this->observations->addObservation(1, [520, 3.19, 0, 1, 0]);
        $this->observations->addObservation(1, [620, 3.95, 0, 1, 0]);
        $this->observations->addObservation(1, [520, 3.9, 0, 1, 0]);
        $this->observations->addObservation(0, [380, 3.34, 0, 1, 0]);
        $this->observations->addObservation(0, [560, 3.24, 0, 0, 1]);
        $this->observations->addObservation(1, [600, 3.64, 0, 1, 0]);
        $this->observations->addObservation(1, [680, 3.46, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 2.81, 0, 1, 0]);
        $this->observations->addObservation(1, [640, 3.95, 1, 0, 0]);
        $this->observations->addObservation(0, [540, 3.33, 0, 1, 0]);
        $this->observations->addObservation(1, [680, 3.67, 1, 0, 0]);
        $this->observations->addObservation(0, [660, 3.32, 0, 0, 0]);
        $this->observations->addObservation(0, [520, 3.12, 1, 0, 0]);
        $this->observations->addObservation(1, [600, 2.98, 1, 0, 0]);
        $this->observations->addObservation(0, [460, 3.77, 0, 1, 0]);
        $this->observations->addObservation(1, [580, 3.58, 0, 0, 0]);
        $this->observations->addObservation(1, [680, 3, 0, 0, 1]);
        $this->observations->addObservation(1, [660, 3.14, 1, 0, 0]);
        $this->observations->addObservation(0, [660, 3.94, 1, 0, 0]);
        $this->observations->addObservation(0, [360, 3.27, 0, 1, 0]);
        $this->observations->addObservation(0, [660, 3.45, 0, 0, 1]);
        $this->observations->addObservation(0, [520, 3.1, 0, 0, 1]);
        $this->observations->addObservation(1, [440, 3.39, 1, 0, 0]);
        $this->observations->addObservation(0, [600, 3.31, 0, 0, 1]);
        $this->observations->addObservation(1, [800, 3.22, 0, 0, 0]);
        $this->observations->addObservation(1, [660, 3.7, 0, 0, 1]);
        $this->observations->addObservation(0, [800, 3.15, 0, 0, 1]);
        $this->observations->addObservation(0, [420, 2.26, 0, 0, 1]);
        $this->observations->addObservation(1, [620, 3.45, 1, 0, 0]);
        $this->observations->addObservation(0, [800, 2.78, 1, 0, 0]);
        $this->observations->addObservation(0, [680, 3.7, 1, 0, 0]);
        $this->observations->addObservation(0, [800, 3.97, 0, 0, 0]);
        $this->observations->addObservation(0, [480, 2.55, 0, 0, 0]);
        $this->observations->addObservation(0, [520, 3.25, 0, 1, 0]);
        $this->observations->addObservation(0, [560, 3.16, 0, 0, 0]);
        $this->observations->addObservation(0, [460, 3.07, 1, 0, 0]);
        $this->observations->addObservation(0, [540, 3.5, 1, 0, 0]);
        $this->observations->addObservation(0, [720, 3.4, 0, 1, 0]);
        $this->observations->addObservation(0, [640, 3.3, 1, 0, 0]);
        $this->observations->addObservation(1, [660, 3.6, 0, 1, 0]);
        $this->observations->addObservation(1, [400, 3.15, 1, 0, 0]);
        $this->observations->addObservation(1, [680, 3.98, 1, 0, 0]);
        $this->observations->addObservation(0, [220, 2.83, 0, 1, 0]);
        $this->observations->addObservation(0, [580, 3.46, 0, 0, 1]);
        $this->observations->addObservation(1, [540, 3.17, 0, 0, 0]);
        $this->observations->addObservation(0, [580, 3.51, 1, 0, 0]);
        $this->observations->addObservation(0, [540, 3.13, 1, 0, 0]);
        $this->observations->addObservation(0, [440, 2.98, 0, 1, 0]);
        $this->observations->addObservation(0, [560, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [660, 3.67, 1, 0, 0]);
        $this->observations->addObservation(0, [660, 3.77, 0, 1, 0]);
        $this->observations->addObservation(1, [520, 3.65, 0, 0, 1]);
        $this->observations->addObservation(0, [540, 3.46, 0, 0, 1]);
        $this->observations->addObservation(1, [300, 2.84, 1, 0, 0]);
        $this->observations->addObservation(1, [340, 3, 1, 0, 0]);
        $this->observations->addObservation(1, [780, 3.63, 0, 0, 1]);
        $this->observations->addObservation(1, [480, 3.71, 0, 0, 1]);
        $this->observations->addObservation(0, [540, 3.28, 0, 0, 0]);
        $this->observations->addObservation(0, [460, 3.14, 0, 1, 0]);
        $this->observations->addObservation(0, [460, 3.58, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 3.01, 0, 0, 1]);
        $this->observations->addObservation(0, [420, 2.69, 1, 0, 0]);
        $this->observations->addObservation(0, [520, 2.7, 0, 1, 0]);
        $this->observations->addObservation(0, [680, 3.9, 0, 0, 0]);
        $this->observations->addObservation(0, [680, 3.31, 1, 0, 0]);
        $this->observations->addObservation(1, [560, 3.48, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 3.34, 1, 0, 0]);
        $this->observations->addObservation(0, [500, 2.93, 0, 0, 1]);
        $this->observations->addObservation(0, [740, 4, 0, 1, 0]);
        $this->observations->addObservation(0, [660, 3.59, 0, 1, 0]);
        $this->observations->addObservation(0, [420, 2.96, 0, 0, 0]);
        $this->observations->addObservation(0, [560, 3.43, 0, 1, 0]);
        $this->observations->addObservation(1, [460, 3.64, 0, 1, 0]);
        $this->observations->addObservation(1, [620, 3.71, 0, 0, 0]);
        $this->observations->addObservation(0, [520, 3.15, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.09, 0, 0, 1]);
        $this->observations->addObservation(0, [540, 3.2, 0, 0, 0]);
        $this->observations->addObservation(1, [660, 3.47, 0, 1, 0]);
        $this->observations->addObservation(0, [500, 3.23, 0, 0, 1]);
        $this->observations->addObservation(1, [560, 2.65, 0, 1, 0]);
        $this->observations->addObservation(0, [500, 3.95, 0, 0, 1]);
        $this->observations->addObservation(0, [580, 3.06, 1, 0, 0]);
        $this->observations->addObservation(0, [520, 3.35, 0, 1, 0]);
        $this->observations->addObservation(0, [500, 3.03, 0, 1, 0]);
        $this->observations->addObservation(0, [600, 3.35, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 3.8, 1, 0, 0]);
        $this->observations->addObservation(0, [400, 3.36, 1, 0, 0]);
        $this->observations->addObservation(0, [620, 2.85, 1, 0, 0]);
        $this->observations->addObservation(1, [780, 4, 1, 0, 0]);
        $this->observations->addObservation(0, [620, 3.43, 0, 1, 0]);
        $this->observations->addObservation(1, [580, 3.12, 0, 1, 0]);
        $this->observations->addObservation(0, [700, 3.52, 1, 0, 0]);
        $this->observations->addObservation(1, [540, 3.78, 1, 0, 0]);
        $this->observations->addObservation(1, [760, 2.81, 0, 0, 0]);
        $this->observations->addObservation(0, [700, 3.27, 1, 0, 0]);
        $this->observations->addObservation(0, [720, 3.31, 0, 0, 0]);
        $this->observations->addObservation(1, [560, 3.69, 0, 1, 0]);
        $this->observations->addObservation(0, [720, 3.94, 0, 1, 0]);
        $this->observations->addObservation(1, [520, 4, 0, 0, 0]);
        $this->observations->addObservation(1, [540, 3.49, 0, 0, 0]);
        $this->observations->addObservation(0, [680, 3.14, 1, 0, 0]);
        $this->observations->addObservation(0, [460, 3.44, 1, 0, 0]);
        $this->observations->addObservation(1, [560, 3.36, 0, 0, 0]);
        $this->observations->addObservation(0, [480, 2.78, 0, 1, 0]);
        $this->observations->addObservation(0, [460, 2.93, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 3.63, 0, 1, 0]);
        $this->observations->addObservation(0, [580, 4, 0, 0, 0]);
        $this->observations->addObservation(0, [800, 3.89, 1, 0, 0]);
        $this->observations->addObservation(1, [540, 3.77, 1, 0, 0]);
        $this->observations->addObservation(1, [680, 3.76, 0, 1, 0]);
        $this->observations->addObservation(1, [680, 2.42, 0, 0, 0]);
        $this->observations->addObservation(1, [620, 3.37, 0, 0, 0]);
        $this->observations->addObservation(0, [560, 3.78, 1, 0, 0]);
        $this->observations->addObservation(0, [560, 3.49, 0, 0, 1]);
        $this->observations->addObservation(0, [620, 3.63, 1, 0, 0]);
        $this->observations->addObservation(1, [800, 4, 1, 0, 0]);
        $this->observations->addObservation(0, [640, 3.12, 0, 1, 0]);
        $this->observations->addObservation(0, [540, 2.7, 1, 0, 0]);
        $this->observations->addObservation(0, [700, 3.65, 1, 0, 0]);
        $this->observations->addObservation(1, [540, 3.49, 1, 0, 0]);
        $this->observations->addObservation(0, [540, 3.51, 1, 0, 0]);
        $this->observations->addObservation(0, [660, 4, 0, 0, 0]);
        $this->observations->addObservation(1, [480, 2.62, 1, 0, 0]);
        $this->observations->addObservation(0, [420, 3.02, 0, 0, 0]);
        $this->observations->addObservation(1, [740, 3.86, 1, 0, 0]);
        $this->observations->addObservation(0, [580, 3.36, 1, 0, 0]);
        $this->observations->addObservation(0, [640, 3.17, 1, 0, 0]);
        $this->observations->addObservation(0, [640, 3.51, 1, 0, 0]);
        $this->observations->addObservation(1, [800, 3.05, 1, 0, 0]);
        $this->observations->addObservation(1, [660, 3.88, 1, 0, 0]);
        $this->observations->addObservation(1, [600, 3.38, 0, 1, 0]);
        $this->observations->addObservation(1, [620, 3.75, 1, 0, 0]);
        $this->observations->addObservation(1, [460, 3.99, 0, 1, 0]);
        $this->observations->addObservation(0, [620, 4, 1, 0, 0]);
        $this->observations->addObservation(0, [560, 3.04, 0, 1, 0]);
        $this->observations->addObservation(0, [460, 2.63, 1, 0, 0]);
        $this->observations->addObservation(0, [700, 3.65, 1, 0, 0]);
        $this->observations->addObservation(0, [600, 3.89, 0, 1, 0]);

        $linking = new Logistic;
        $this->regression = new GradientDescent($linking);
        $this->coefficients = $this->regression->regress($this->observations);

        $this->predictor = new Predictor($this->coefficients, $linking);
    }

    public function testPredict()
    {
        $this->assertEquals(0.308, round($this->predictor->predict([200, 3.39, 0, 0, 0]), 3));
    }
}
